<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Etos Patch</title>
  <script src="./assets/js/vendor/jquery-1.9.1.min.js"></script>
  <link href="./assets/css/test.css" rel="stylesheet" type="text/css">

  <style>
    span {
      font-size: 20px;
      font-weight: bold;
    }
  </style>
</head>
<body>
  <span>2021-10-18  patch 내역</span>
  <div>
    <pre>
# 패치 내역
  - 화면 : Dashboard > Edge Monitor 
      - Mouse over시 ip, area, rack 정보 display
  - 화면 : Configuration 
      - box name 수정 기능 추가
      - box 삭제 기능 추가

  - etos agent
      - 로깅 추가

# 패치 백업 
  - setup03/04.apps/etos-mon/etos-mon.jar 파일을 아래와 같이 backup 합니다.
    setup03/04.apps/etos-mon/bak/2021_10_18/etos-mon.jar 
    
    - setup03/04.apps/etos-cli 디렉토리를 압축하고, 압축한 파일을 아래 경로에 backup 합니다.
    setup03/04.apps/etos-cli-bak/2021_10_18/ 

    - setup03/04.apps/etos-agent/etos-agent.jar 파일을 아래와 같이 backup 합니다.
      setup03/04.apps/etos-agent/bak/2021_10_18/etos-agent.jar 

# process start/stop시 유의사항
  - ETOS-MANAGER 프로세스는 1개만 운영되어야 합니다. "windows 작업관리자"에서 반드시 확인하세요.
  - ETOS_AGENT 프로세스는 1개만 운영되어야 합니다. "windows 작업관리자"에서 반드시 확인하세요.
    </pre>
    <img src="assets/java_proc.png" />
    <pre>
# web 화면 변경이 안될경우
  - ctrl+shift+r 버튼(chrome 캐시초기화)을 눌러 변경된 화면을 확인 할 수 있습니다.

    </pre>
  </div>
  
  <br><br>
  <span>etos manager patch (java web app server)</span>
  <div>
    <ol id="manager"></ol>
  </div>

  <br><br>
  <span>etos Web patch</span>
  <div>
    <ol id="web"></ol>
  </div>

  <br><br>
  <span>etos agent patch (box status collector)</span>
  <div>
    <ol id="agent">
    </ol>

    <pre>
modbus:
  partition-count: 100
  port: 502
  connection-time-out: 1000
  so-time-out: 1000 # 설정을 하지 않으려면 음수 값을 지정하면 된다.
  edge-status: 1
  memory:
    os-state: 1
    err-state: 9
    port-state: 10
    </pre>
  </div>

  <br><br>
  <div class="btn01" onclick="document.getElementById('p').style.display=(document.getElementById('p').style.display=='block') ? 'none' : 'block';">+</div>
  <pre id="p" style="display: none;">
select * from edge;
select edge_id, edge_name, action, last_modifed_by , last_modified_date from edge_history eh order by last_modified_date desc;

select * from edge_io;
select edge_io_id, edge_io_type , action, last_modifed_by , last_modified_date from edge_io_history eih order by last_modified_date desc;

select * from device d ;
select device_id , device_name , device_type , edge_id , action, last_modifed_by , last_modified_date from device_history dh order by last_modified_date desc;

select * from device_io di ;
select device_io_id , edge_io_id , edge_io_type , action, last_modifed_by , last_modified_date from device_io_history dih order by last_modified_date desc;

--

select * from edge e where e.edge_id = 2;
select * from edge_history eh where eh.edge_id = 2 order by last_modified_date desc;

select * from edge_io ei where ei.edge_id = 2;

select * from edge_io_history eih;
select * from edge_io_history eih where eih.edge_io_id in (select ei.edge_io_id from edge_io ei where ei.edge_id = 2) order by last_modified_date desc;


select * from device d where d.edge_id = 2;
select * from device_history dh order by last_modified_date desc;

select * from device_history dh where dh.edge_id = 2 order by last_modified_date desc;


select * from device_io di where di.device_id in (select d.device_id from device d where d.edge_id = 2);
select * from device_io_history dih where dih.device_io_id in ( select device_io_id from device_io di where di.device_id in (select d.device_id from device d where d.edge_id = 2) ) order by last_modified_date desc;




truncate device_io_history ;
truncate device_io ;

truncate device_history ;
truncate device ;

truncate edge_io_history ;
truncate edge_io ;

truncate edge_history ;
truncate edge ;

commit;


truncate alarm_history ;
truncate alarm ;
commit;

  </pre>

  
</body>

<script>

  let ymd = '2021_10_18';
  
  // for (let i = 1; i <= 9; i++) {
  //   $('#manager').append(
  //     $(`<li><a href="./patch/${ymd}/etos-mon.zip.00${i}" download>etos-mon.zip.00${i}</a></li>`)
  //   );
  // }
  
  // for (let i = 1; i <= 3; i++) {
  //   $('#web').append(
  //     $(`<li><a href="./patch/${ymd}/etos-cli-patch.zip.00${i}" download>etos-cli-patch.zip.00${i}</a></li>`)
  //   );
  // }

  // for (let i = 1; i <= 8; i++) {
  //   $('#agent').append(
  //     $(`<li><a href="./patch/${ymd}/etos-agent.zip.00${i}" download>etos-agent.zip.00${i}</a></li>`)
  //   );
  // }



</script>


</html>
